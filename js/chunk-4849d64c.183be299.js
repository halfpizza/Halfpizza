/*!
 *  build: admin-pro 
 *  copyright: chuzhixin 1204505056@qq.com 
 *  time: 2021-11-7 15:40:52
 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4849d64c"],{2058:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"asset_page"},[a("div",{staticClass:"asset_main"},[a("el-row",{attrs:{gutter:60}},[a("el-col",{attrs:{lg:14,md:14}},[a("div",{staticClass:"asset_title"},[e._v(e._s(e.translateTitle("管理资金")))]),a("div",[a("div",{staticClass:"asset_desc"},[e._v("货币/PIZA")]),a("div",{staticClass:"withdraw_row"},[a("span",[e._v(e._s(e.balance)+" PIZA")]),a("img",{attrs:{src:n("ee13"),alt:""}}),a("div",{staticClass:"withdraw_btn",on:{click:e.withdraw}},[e._v(e._s(e.translateTitle("提现到钱包")))])])]),a("div",{staticClass:"nft_list"},[a("div",{staticClass:"nft_title"},[e._v("NFT")]),e._l(e.owner,(function(t){return a("div",{key:t.token,staticClass:"token_list",on:{click:function(n){e.previewUrl=t.url}}},[a("div",{staticClass:"token_name"},[e._v(e._s(e.translateTitle("名称"))+" ："+e._s(t.title))]),a("div",{staticClass:"token_num"},[e._v("token ："+e._s(t.token))])])}))],2)]),a("el-col",{attrs:{lg:10,md:10}},[a("div",{staticClass:"asset_title"},[e._v(e._s(e.translateTitle("NFT预览")))]),a("div",{staticClass:"img_prev"},[e.previewUrl?a("img",{staticClass:"img_prev_main",attrs:{src:e.previewUrl,alt:""}}):e._e()])])],1)],1)])},r=[],s=n("1da1"),i=n("5530"),c=(n("d3b7"),n("a9e3"),n("159b"),n("25f0"),n("3ca3"),n("ddb0"),n("96cf"),n("79fa")),o=n("2f62"),u=n("c030"),d={name:"NftAsset",data:function(){return{owner:[],previewUrl:"",balance:0}},mounted:function(){this.getData()},computed:Object(i["a"])({},Object(o["c"])({address:"connect/address",metamask:"settings/metamask",chainID:"connect/chainID"})),watch:{chainID:function(){this.getData()},address:function(){this.getData()}},methods:{translateTitle:c["translateTitle"],getData:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.getOwnerData(),t.next=3,e.getBonus();case 3:e.balance=t.sent;case 4:case"end":return t.stop()}}),t)})))()},getBonus:function(){var e=this;return new Promise((function(t){if(!e.address||e.chainID!=e.runChainID)return t(0),!1;var n=new u["a"].providers.Web3Provider(window.ethereum),a=new u["a"].Contract(e.metamask.sellAddress,e.metamask.sellAbi,n);a.balanceOf(e.address).then((function(e){var n=Number(e);t(n)})).catch((function(e){t(0)}))}))},getOwnerNft:function(){var e=this;return new Promise((function(t){if(!e.address||e.chainID!==e.runChainID)return t([]),!1;var n=new u["a"].providers.Web3Provider(window.ethereum),a=new u["a"].Contract(e.metamask.nftAddress,e.metamask.nftAbI,n);a.getownertoken(e.address).then((function(e){t(e)})).catch((function(e){t([])}))}))},getTokenInfo:function(e){var t=this;return new Promise(function(){var n=Object(s["a"])(regeneratorRuntime.mark((function n(a){var r,s,i,c,o,d;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.address&&t.chainID===t.runChainID){n.next=3;break}return a(null),n.abrupt("return",!1);case 3:return r=new u["a"].providers.Web3Provider(window.ethereum),s=new u["a"].Contract(t.metamask.nftAddress,t.metamask.nftAbI,r),n.next=7,s.tokeninfo(e);case 7:return i=n.sent,n.next=10,s.ownerOf(e);case 10:return c=n.sent,n.next=13,s.tokenURI(e);case 13:o=n.sent,d={title:i[0],symbol_txt:i[1],describe:i[2],owner:c,url:o,token:e},a(d);case 16:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())},withdrawFn:function(){var e=this;return new Promise((function(t){var n=new u["a"].providers.Web3Provider(window.ethereum),a=new u["a"].Contract(e.metamask.sellAddress,e.metamask.sellAbi,n);a.connect(n.getSigner()).withdraw(e.address).then((function(e){t(e.hash)})).catch((function(e){t(!1)}))}))},getTokenIdentity:function(e){var t=this;return new Promise((function(n){t.$ajax({url:"userIdentity",method:"post",data:{token:e}}).then((function(e){var t=e.data||[],a={};t.forEach((function(e){e.token&&(a[e.token]=e)})),n(a)})).catch((function(e){n(!1)}))}))},getOwnerData:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n,a,r,s,i,c,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getOwnerNft();case 2:return n=t.sent,a=[],r={},n.forEach((function(t,n){r[t.toString()]=n,a.push(e.getTokenInfo(t.toString()))})),t.next=8,Promise.all(a);case 8:return s=t.sent,i=[],t.next=12,e.getTokenIdentity(r);case 12:c=t.sent,o={},s.forEach((function(e){!o[e.token]&&c[e.token]&&1==c[e.token]["status"]&&(o[e.token]=!0,i.push(e))})),e.owner=i;case 16:case"end":return t.stop()}}),t)})))()},withdraw:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.balance>0)){t.next=16;break}return n=e.$baseLoading(3,"withdraw sending"),t.next=4,e.withdrawFn();case 4:if(a=t.sent,a){t.next=9;break}return e.$message.error("withdraw fail"),n.close(),t.abrupt("return",!1);case 9:return t.next=11,e.$getTradeByHash(a);case 11:r=t.sent,n.close(),r?(e.getData(),e.$message.success("withdraw success")):e.$message.error("withdraw fail"),t.next=17;break;case 16:e.$message.warning("user asset balance is 0");case 17:case"end":return t.stop()}}),t)})))()}}},l=d,f=(n("4d6d"),n("2877")),w=Object(f["a"])(l,a,r,!1,null,null,null);t["default"]=w.exports},"4d6d":function(e,t,n){"use strict";n("f50b")},ee13:function(e,t,n){e.exports=n.p+"static/img/logo1.aacda647.png"},f50b:function(e,t,n){e.exports={"menu-color":"rgba(255,255,255,.95)","menu-color-active":"rgba(255,255,255,.95)","menu-background":"#282c34","column-second-menu-background":"#fff"}}}]);